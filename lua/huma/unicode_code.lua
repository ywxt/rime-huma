local segments = {
    { first = 0x0000, last = 0x007F, name = '基本拉丁字母' },
    { first = 0x0080, last = 0x00FF, name = '拉丁字母補充-1' },
    { first = 0x0100, last = 0x017F, name = '拉丁字母擴展-A' },
    { first = 0x0180, last = 0x024F, name = '拉丁字母擴展-B' },
    { first = 0x0250, last = 0x02AF, name = '國際音標擴展' },
    { first = 0x02B0, last = 0x02FF, name = '佔位修飾符號' },
    { first = 0x0300, last = 0x036F, name = '組合附加符號' },
    { first = 0x0370, last = 0x03FF, name = '希臘字母和科普特字母' },
    { first = 0x0400, last = 0x04FF, name = '西里爾字母' },
    { first = 0x0500, last = 0x052F, name = '西里爾字母補充' },
    { first = 0x0530, last = 0x058F, name = '亞美尼亞字母' },
    { first = 0x0590, last = 0x05FF, name = '希伯來文字母' },
    { first = 0x0600, last = 0x06FF, name = '阿拉伯文字母' },
    { first = 0x0700, last = 0x074F, name = '敘利亞字母' },
    { first = 0x0750, last = 0x077F, name = '阿拉伯文補充' },
    { first = 0x0780, last = 0x07BF, name = '它拿字母' },
    { first = 0x07C0, last = 0x07FF, name = '西非書面文字' },
    { first = 0x0800, last = 0x083F, name = '撒瑪利亞字母' },
    { first = 0x0840, last = 0x085F, name = '曼達安字母' },
    { first = 0x0860, last = 0x086F, name = '敘利亞文補充' },
    { first = 0x0870, last = 0x089F, name = '阿拉伯字母擴展-B' },
    { first = 0x08A0, last = 0x08FF, name = '阿拉伯字母擴展-A' },
    { first = 0x0900, last = 0x097F, name = '天城文' },
    { first = 0x0980, last = 0x09FF, name = '孟加拉文' },
    { first = 0x0A00, last = 0x0A7F, name = '古木基文' },
    { first = 0x0A80, last = 0x0AFF, name = '古吉拉特文' },
    { first = 0x0B00, last = 0x0B7F, name = '奧里亞文' },
    { first = 0x0B80, last = 0x0BFF, name = '泰米爾文' },
    { first = 0x0C00, last = 0x0C7F, name = '泰盧固文' },
    { first = 0x0C80, last = 0x0CFF, name = '卡納達文' },
    { first = 0x0D00, last = 0x0D7F, name = '馬拉雅拉姆文' },
    { first = 0x0D80, last = 0x0DFF, name = '僧伽羅文' },
    { first = 0x0E00, last = 0x0E7F, name = '泰文' },
    { first = 0x0E80, last = 0x0EFF, name = '寮文' },
    { first = 0x0F00, last = 0x0FFF, name = '藏文' },
    { first = 0x1000, last = 0x109F, name = '緬甸文' },
    { first = 0x10A0, last = 0x10FF, name = '喬治亞字母' },
    { first = 0x1100, last = 0x11FF, name = '諺文字母' },
    { first = 0x1200, last = 0x137F, name = '衣索比亞字母' },
    { first = 0x1380, last = 0x139F, name = '衣索比亞字母補充' },
    { first = 0x13A0, last = 0x13FF, name = '切羅基文' },
    { first = 0x1400, last = 0x167F, name = '統一加拿大原住民音節文字' },
    { first = 0x1680, last = 0x169F, name = '歐甘字母' },
    { first = 0x16A0, last = 0x16FF, name = '盧恩字母' },
    { first = 0x1700, last = 0x171F, name = '他加祿字母' },
    { first = 0x1720, last = 0x173F, name = '哈努諾文' },
    { first = 0x1740, last = 0x175F, name = '布希德字母' },
    { first = 0x1760, last = 0x177F, name = '塔格班瓦字母' },
    { first = 0x1780, last = 0x17FF, name = '高棉文' },
    { first = 0x1800, last = 0x18AF, name = '蒙古文' },
    { first = 0x18B0, last = 0x18FF, name = '統一加拿大原住民音節文字擴充' },
    { first = 0x1900, last = 0x194F, name = '林布文' },
    { first = 0x1950, last = 0x197F, name = '德宏傣文' },
    { first = 0x1980, last = 0x19DF, name = '新傣仂文' },
    { first = 0x19E0, last = 0x19FF, name = '高棉文符號' },
    { first = 0x1A00, last = 0x1A1F, name = '布吉文' },
    { first = 0x1A20, last = 0x1AAF, name = '老傣仂文' },
    { first = 0x1AB0, last = 0x1AFF, name = '組合附加符號擴展' },
    { first = 0x1B00, last = 0x1B7F, name = '峇里字母' },
    { first = 0x1B80, last = 0x1BBF, name = '巽他字母' },
    { first = 0x1BC0, last = 0x1BFF, name = '巴塔克字母' },
    { first = 0x1C00, last = 0x1C4F, name = '絨巴文' },
    { first = 0x1C50, last = 0x1C7F, name = '桑塔利文' },
    { first = 0x1C80, last = 0x1C8F, name = '西里爾字母擴展-C' },
    { first = 0x1C90, last = 0x1CBF, name = '喬治亞字母擴展' },
    { first = 0x1CC0, last = 0x1CCF, name = '巽他字母補充' },
    { first = 0x1CD0, last = 0x1CFF, name = '吠陀擴展' },
    { first = 0x1D00, last = 0x1D7F, name = '音標擴展' },
    { first = 0x1D80, last = 0x1DBF, name = '音標擴展補充' },
    { first = 0x1DC0, last = 0x1DFF, name = '組合附加符號補充' },
    { first = 0x1E00, last = 0x1EFF, name = '拉丁字母擴展附加' },
    { first = 0x1F00, last = 0x1FFF, name = '希臘字母擴展' },
    { first = 0x2000, last = 0x206F, name = '一般標點' },
    { first = 0x2070, last = 0x209F, name = '上標及下標' },
    { first = 0x20A0, last = 0x20CF, name = '貨幣符號' },
    { first = 0x20D0, last = 0x20FF, name = '符號用組合附加符號' },
    { first = 0x2100, last = 0x214F, name = '類字母符號' },
    { first = 0x2150, last = 0x218F, name = '數字形式' },
    { first = 0x2190, last = 0x21FF, name = '箭頭' },
    { first = 0x2200, last = 0x22FF, name = '數學運算子' },
    { first = 0x2300, last = 0x23FF, name = '雜項技術符號' },
    { first = 0x2400, last = 0x243F, name = '控制圖形' },
    { first = 0x2440, last = 0x245F, name = '光學字元識別' },
    { first = 0x2460, last = 0x24FF, name = '圍繞字母數字' },
    { first = 0x2500, last = 0x257F, name = '制表符' },
    { first = 0x2580, last = 0x259F, name = '方塊元素' },
    { first = 0x25A0, last = 0x25FF, name = '幾何圖形' },
    { first = 0x2600, last = 0x26FF, name = '雜項符號' },
    { first = 0x2700, last = 0x27BF, name = '裝飾符號' },
    { first = 0x27C0, last = 0x27EF, name = '雜項數學符號-A' },
    { first = 0x27F0, last = 0x27FF, name = '追加箭頭-A' },
    { first = 0x2800, last = 0x28FF, name = '點字圖案' },
    { first = 0x2900, last = 0x297F, name = '追加箭頭-B' },
    { first = 0x2980, last = 0x29FF, name = '雜項數學符號-B' },
    { first = 0x2A00, last = 0x2AFF, name = '補充數學運算子' },
    { first = 0x2B00, last = 0x2BFF, name = '雜項符號和箭頭' },
    { first = 0x2C00, last = 0x2C5F, name = '格拉哥里字母' },
    { first = 0x2C60, last = 0x2C7F, name = '拉丁字母擴展-C' },
    { first = 0x2C80, last = 0x2CFF, name = '科普特字母' },
    { first = 0x2D00, last = 0x2D2F, name = '喬治亞字母補充' },
    { first = 0x2D30, last = 0x2D7F, name = '提非納文' },
    { first = 0x2D80, last = 0x2DDF, name = '衣索比亞字母擴充' },
    { first = 0x2DE0, last = 0x2DFF, name = '西里爾字母擴展-A' },
    { first = 0x2E00, last = 0x2E7F, name = '補充標點' },
    { first = 0x2E80, last = 0x2EFF, name = '中日韓漢字部首補充' },
    { first = 0x2F00, last = 0x2FDF, name = '康熙部首' },
    { first = 0x2FF0, last = 0x2FFF, name = '表意文字描述字元' },
    { first = 0x3000, last = 0x303F, name = '中日韓符號和標點' },
    { first = 0x3040, last = 0x309F, name = '平假名' },
    { first = 0x30A0, last = 0x30FF, name = '片假名' },
    { first = 0x3100, last = 0x312F, name = '注音符號' },
    { first = 0x3130, last = 0x318F, name = '諺文相容字母' },
    { first = 0x3190, last = 0x319F, name = '漢文訓讀符號' },
    { first = 0x31A0, last = 0x31BF, name = '注音符號擴展' },
    { first = 0x31C0, last = 0x31EF, name = '中日韓筆畫' },
    { first = 0x31F0, last = 0x31FF, name = '片假名語音擴展' },
    { first = 0x3200, last = 0x32FF, name = '中日韓圍繞字元及月份' },
    { first = 0x3300, last = 0x33FF, name = '中日韓相容字元' },
    { first = 0x3400, last = 0x4DBF, name = '中日韓統一表意文字擴充區A' },
    { first = 0x4DC0, last = 0x4DFF, name = '易經六十四卦符號' },
    { first = 0x4E00, last = 0x9FFF, name = '中日韓統一表意文字 (基本區)' },
    { first = 0xA000, last = 0xA48F, name = '彝文音節' },
    { first = 0xA490, last = 0xA4CF, name = '彝文部首' },
    { first = 0xA4D0, last = 0xA4FF, name = '傈僳文' },
    { first = 0xA500, last = 0xA63F, name = '瓦伊文' },
    { first = 0xA640, last = 0xA69F, name = '西里爾字母擴展-B' },
    { first = 0xA6A0, last = 0xA6FF, name = '巴姆穆文字' },
    { first = 0xA700, last = 0xA71F, name = '聲調修飾符號' },
    { first = 0xA720, last = 0xA7FF, name = '拉丁字母擴展-D' },
    { first = 0xA800, last = 0xA82F, name = '錫爾赫特文' },
    { first = 0xA830, last = 0xA83F, name = '通用印度數字形式' },
    { first = 0xA840, last = 0xA87F, name = '八思巴文' },
    { first = 0xA880, last = 0xA8DF, name = '條拉什特拉文' },
    { first = 0xA8E0, last = 0xA8FF, name = '天城文擴展' },
    { first = 0xA900, last = 0xA92F, name = '克耶字母' },
    { first = 0xA930, last = 0xA95F, name = '勒姜字母' },
    { first = 0xA960, last = 0xA97F, name = '諺文字母擴展-A' },
    { first = 0xA980, last = 0xA9DF, name = '爪哇字母' },
    { first = 0xA9E0, last = 0xA9FF, name = '緬甸文擴展-B' },
    { first = 0xAA00, last = 0xAA5F, name = '占文' },
    { first = 0xAA60, last = 0xAA7F, name = '緬甸文擴展-A' },
    { first = 0xAA80, last = 0xAADF, name = '傣越文' },
    { first = 0xAAE0, last = 0xAAFF, name = '梅泰文擴充' },
    { first = 0xAB00, last = 0xAB2F, name = '衣索比亞字母擴充-A' },
    { first = 0xAB30, last = 0xAB6F, name = '拉丁字母擴展-E' },
    { first = 0xAB70, last = 0xABBF, name = '切羅基文補充' },
    { first = 0xABC0, last = 0xABFF, name = '梅泰文' },
    { first = 0xAC00, last = 0xD7AF, name = '諺文音節' },
    { first = 0xD7B0, last = 0xD7FF, name = '諺文字母擴展-B' },
    { first = 0xD800, last = 0xDB7F, name = '高半代用區' },
    { first = 0xDB80, last = 0xDBFF, name = '高半私人代用區' },
    { first = 0xDC00, last = 0xDFFF, name = '低半代用區' },
    { first = 0xE000, last = 0xF8FF, name = '私用區' },
    { first = 0xF900, last = 0xFAFF, name = '中日韓相容表意文字' },
    { first = 0xFB00, last = 0xFB4F, name = '字母表達形式' },
    { first = 0xFB50, last = 0xFDFF, name = '阿拉伯字母表達形式-A' },
    { first = 0xFE00, last = 0xFE0F, name = '變體選擇符' },
    { first = 0xFE10, last = 0xFE1F, name = '豎排形式' },
    { first = 0xFE20, last = 0xFE2F, name = '組合用半符號' },
    { first = 0xFE30, last = 0xFE4F, name = '中日韓相容形式' },
    { first = 0xFE50, last = 0xFE6F, name = '小寫變體形式' },
    { first = 0xFE70, last = 0xFEFF, name = '阿拉伯字母表達形式-B' },
    { first = 0xFF00, last = 0xFFEF, name = '半形及全形字元' },
    { first = 0xFFF0, last = 0xFFFF, name = '特殊' },
    { first = 0x10000, last = 0x1007F, name = '線形文字B音節文字' },
    { first = 0x10080, last = 0x100FF, name = '線形文字B表意文字' },
    { first = 0x10100, last = 0x1013F, name = '愛琴海數字' },
    { first = 0x10140, last = 0x1018F, name = '古希臘數字' },
    { first = 0x10190, last = 0x101CF, name = '古代符號' },
    { first = 0x101D0, last = 0x101FF, name = '斐斯托斯圓盤' },
    { first = 0x10280, last = 0x1029F, name = '呂基亞字母' },
    { first = 0x102A0, last = 0x102DF, name = '卡里亞字母' },
    { first = 0x102E0, last = 0x102FF, name = '科普特閏餘數字' },
    { first = 0x10300, last = 0x1032F, name = '古義大利字母' },
    { first = 0x10330, last = 0x1034F, name = '哥特字母' },
    { first = 0x10350, last = 0x1037F, name = '古彼爾姆文' },
    { first = 0x10380, last = 0x1039F, name = '烏加里特字母' },
    { first = 0x103A0, last = 0x103DF, name = '古波斯楔形文字' },
    { first = 0x10400, last = 0x1044F, name = '德瑟雷特字母' },
    { first = 0x10450, last = 0x1047F, name = '蕭伯納字母' },
    { first = 0x10480, last = 0x104AF, name = '奧斯曼亞字母' },
    { first = 0x104B0, last = 0x104FF, name = '歐塞奇字母' },
    { first = 0x10500, last = 0x1052F, name = '愛爾巴桑字母' },
    { first = 0x10530, last = 0x1056F, name = '高加條阿爾巴尼亞字母' },
    { first = 0x10570, last = 0x105BF, name = '維斯庫奇文' },
    { first = 0x10600, last = 0x1077F, name = '線形文字A' },
    { first = 0x10780, last = 0x107BF, name = '拉丁字母擴展-F' },
    { first = 0x10800, last = 0x1083F, name = '賽普勒斯音節文字' },
    { first = 0x10840, last = 0x1085F, name = '帝國亞拉姆文' },
    { first = 0x10860, last = 0x1087F, name = '帕爾邁拉字母' },
    { first = 0x10880, last = 0x108AF, name = '納巴泰字母' },
    { first = 0x108E0, last = 0x108FF, name = '哈特拉文' },
    { first = 0x10900, last = 0x1091F, name = '腓尼基字母' },
    { first = 0x10920, last = 0x1093F, name = '呂底亞字母' },
    { first = 0x10980, last = 0x1099F, name = '麥羅埃文聖書體' },
    { first = 0x109A0, last = 0x109FF, name = '麥羅埃文草書體' },
    { first = 0x10A00, last = 0x10A5F, name = '佉盧文' },
    { first = 0x10A60, last = 0x10A7F, name = '古南阿拉伯字母' },
    { first = 0x10A80, last = 0x10A9F, name = '古北阿拉伯字母' },
    { first = 0x10AC0, last = 0x10AFF, name = '摩尼字母' },
    { first = 0x10B00, last = 0x10B3F, name = '阿維斯陀字母' },
    { first = 0x10B40, last = 0x10B5F, name = '碑刻帕提亞文' },
    { first = 0x10B60, last = 0x10B7F, name = '碑刻巴列維文' },
    { first = 0x10B80, last = 0x10BAF, name = '詩篇巴列維文' },
    { first = 0x10C00, last = 0x10C4F, name = '古突厥文' },
    { first = 0x10C80, last = 0x10CFF, name = '古匈牙利字母' },
    { first = 0x10D00, last = 0x10D3F, name = '哈乃斐羅興亞文字' },
    { first = 0x10E60, last = 0x10E7F, name = '盧米文數字' },
    { first = 0x10E80, last = 0x10EBF, name = '雅茲迪文' },
    { first = 0x10EC0, last = 0x10EFF, name = '阿拉伯字母擴展-C' },
    { first = 0x10F00, last = 0x10F2F, name = '古粟特字母' },
    { first = 0x10F30, last = 0x10F6F, name = '粟特字母' },
    { first = 0x10F70, last = 0x10FAF, name = '回鶻字母' },
    { first = 0x10FB0, last = 0x10FDF, name = '花剌子模字母' },
    { first = 0x10FE0, last = 0x10FFF, name = '埃利邁文' },
    { first = 0x11000, last = 0x1107F, name = '婆羅米文' },
    { first = 0x11080, last = 0x110CF, name = '凱提文' },
    { first = 0x110D0, last = 0x110FF, name = '條拉僧平文字' },
    { first = 0x11100, last = 0x1114F, name = '查克馬文' },
    { first = 0x11150, last = 0x1117F, name = '馬哈佳尼文' },
    { first = 0x11180, last = 0x111DF, name = '夏拉達文' },
    { first = 0x111E0, last = 0x111FF, name = '古僧伽羅文數字' },
    { first = 0x11200, last = 0x1124F, name = '可吉文' },
    { first = 0x11280, last = 0x112AF, name = '穆爾塔尼文' },
    { first = 0x112B0, last = 0x112FF, name = '庫達瓦迪文' },
    { first = 0x11300, last = 0x1137F, name = '古蘭塔文' },
    { first = 0x11400, last = 0x1147F, name = '紐瓦字母' },
    { first = 0x11480, last = 0x114DF, name = '底羅僕多文' },
    { first = 0x11580, last = 0x115FF, name = '悉曇文字' },
    { first = 0x11600, last = 0x1165F, name = '莫迪文' },
    { first = 0x11660, last = 0x1167F, name = '蒙古文補充' },
    { first = 0x11680, last = 0x116CF, name = '塔克里文' },
    { first = 0x11700, last = 0x1174F, name = '阿洪姆文' },
    { first = 0x11800, last = 0x1184F, name = '多格拉文' },
    { first = 0x118A0, last = 0x118FF, name = '瓦蘭齊地文' },
    { first = 0x11900, last = 0x1195F, name = '島嶼字母' },
    { first = 0x119A0, last = 0x119FF, name = '南迪城文' },
    { first = 0x11A00, last = 0x11A4F, name = '札那巴札爾方形字母' },
    { first = 0x11A50, last = 0x11AAF, name = '條永布文字' },
    { first = 0x11AB0, last = 0x11ABF, name = '加拿大原住民音節文字擴展-A' },
    { first = 0x11AC0, last = 0x11AFF, name = '包欽豪文' },
    { first = 0x11B00, last = 0x11B5F, name = '天城文擴展-A' },
    { first = 0x11C00, last = 0x11C6F, name = '拜克舒基文' },
    { first = 0x11C70, last = 0x11CBF, name = '瑪欽文' },
    { first = 0x11D00, last = 0x11D5F, name = '馬薩拉姆貢德文字' },
    { first = 0x11D60, last = 0x11DAF, name = '貢賈拉貢德文字' },
    { first = 0x11EE0, last = 0x11EFF, name = '望加錫文' },
    { first = 0x11F00, last = 0x11F5F, name = '卡維文' },
    { first = 0x11FB0, last = 0x11FBF, name = '老傈僳文補充' },
    { first = 0x11FC0, last = 0x11FFF, name = '泰米爾文補充' },
    { first = 0x12000, last = 0x123FF, name = '楔形文字' },
    { first = 0x12400, last = 0x1247F, name = '楔形文字數字和標點符號' },
    { first = 0x12480, last = 0x1254F, name = '早期王朝楔形文字' },
    { first = 0x12F90, last = 0x12FFF, name = '賽普勒斯-米諾斯文字' },
    { first = 0x13000, last = 0x1342F, name = '埃及聖書體' },
    { first = 0x13430, last = 0x1345F, name = '埃及聖書體格式控制' },
    { first = 0x14400, last = 0x1467F, name = '安納托利亞象形文字' },
    { first = 0x16800, last = 0x16A3F, name = '巴姆穆文字補充' },
    { first = 0x16A40, last = 0x16A6F, name = '默祿文' },
    { first = 0x16A70, last = 0x16ACF, name = '唐薩文' },
    { first = 0x16AD0, last = 0x16AFF, name = '巴薩文' },
    { first = 0x16B00, last = 0x16B8F, name = '救世苗文' },
    { first = 0x16E40, last = 0x16E9F, name = '梅德法伊德林文' },
    { first = 0x16F00, last = 0x16F9F, name = '柏格理苗文' },
    { first = 0x16FE0, last = 0x16FFF, name = '表意符號和標點符號' },
    { first = 0x17000, last = 0x187FF, name = '西夏文' },
    { first = 0x18800, last = 0x18AFF, name = '西夏文部件' },
    { first = 0x18B00, last = 0x18CFF, name = '契丹小字' },
    { first = 0x18D00, last = 0x18D7F, name = '西夏文補充' },
    { first = 0x1AFF0, last = 0x1AFFF, name = '假名擴展-B' },
    { first = 0x1B000, last = 0x1B0FF, name = '假名補充' },
    { first = 0x1B100, last = 0x1B12F, name = '假名擴展-A' },
    { first = 0x1B130, last = 0x1B16F, name = '小型假名擴充' },
    { first = 0x1B170, last = 0x1B2FF, name = '女書' },
    { first = 0x1BC00, last = 0x1BC9F, name = '杜普雷速記' },
    { first = 0x1BCA0, last = 0x1BCAF, name = '速記格式控制符' },
    { first = 0x1CF00, last = 0x1CFCF, name = '贊玫尼聖歌音樂符號' },
    { first = 0x1D000, last = 0x1D0FF, name = '拜占庭音樂符號' },
    { first = 0x1D100, last = 0x1D1FF, name = '音樂符號' },
    { first = 0x1D200, last = 0x1D24F, name = '古希臘音樂記號' },
    { first = 0x1D2C0, last = 0x1D2DF, name = '卡克托維克數字' },
    { first = 0x1D2E0, last = 0x1D2FF, name = '瑪雅數字' },
    { first = 0x1D300, last = 0x1D35F, name = '太玄經符號' },
    { first = 0x1D360, last = 0x1D37F, name = '算籌' },
    { first = 0x1D400, last = 0x1D7FF, name = '字母和數字符號' },
    { first = 0x1D800, last = 0x1DAAF, name = '薩頓書寫符號' },
    { first = 0x1DF00, last = 0x1DFFF, name = '拉丁字母擴展-G' },
    { first = 0x1E000, last = 0x1E02F, name = '格拉哥里字母補充' },
    { first = 0x1E030, last = 0x1E08F, name = '西里爾字母擴展-D' },
    { first = 0x1E100, last = 0x1E14F, name = '創世紀苗文' },
    { first = 0x1E290, last = 0x1E2BF, name = '投投文' },
    { first = 0x1E2C0, last = 0x1E2FF, name = '文喬字母' },
    { first = 0x1E4D0, last = 0x1E4FF, name = '蒙達里字母' },
    { first = 0x1E7E0, last = 0x1E7FF, name = '衣索比亞字母擴充-B' },
    { first = 0x1E800, last = 0x1E8DF, name = '門德基卡庫文' },
    { first = 0x1E900, last = 0x1E95F, name = '阿德拉姆字母' },
    { first = 0x1EC70, last = 0x1ECBF, name = '印度西亞格數字' },
    { first = 0x1ED00, last = 0x1ED4F, name = '奧斯曼西亞格數字' },
    { first = 0x1EE00, last = 0x1EEFF, name = '阿拉伯字母數字符號' },
    { first = 0x1F000, last = 0x1F02F, name = '麻將牌' },
    { first = 0x1F030, last = 0x1F09F, name = '多米諾骨牌' },
    { first = 0x1F0A0, last = 0x1F0FF, name = '撲克牌' },
    { first = 0x1F100, last = 0x1F1FF, name = '圍繞字母數字補充' },
    { first = 0x1F200, last = 0x1F2FF, name = '圍繞表意文字補充' },
    { first = 0x1F300, last = 0x1F5FF, name = '雜項符號和象形文字' },
    { first = 0x1F600, last = 0x1F64F, name = '表情符號' },
    { first = 0x1F650, last = 0x1F67F, name = '裝飾符號' },
    { first = 0x1F680, last = 0x1F6FF, name = '交通和地圖符號' },
    { first = 0x1F700, last = 0x1F77F, name = '鍊金術符號' },
    { first = 0x1F780, last = 0x1F7FF, name = '幾何圖形擴展' },
    { first = 0x1F800, last = 0x1F8FF, name = '追加箭頭-C' },
    { first = 0x1F900, last = 0x1F9FF, name = '補充符號和象形文字' },
    { first = 0x1FA00, last = 0x1FA6F, name = '棋類符號' },
    { first = 0x1FA70, last = 0x1FAFF, name = '符號和象形文字擴充-A' },
    { first = 0x1FB00, last = 0x1FBFF, name = '遺留計算符號' },
    { first = 0x20000, last = 0x2A6DF, name = '中日韓統一表意文字擴充區B' },
    { first = 0x2A700, last = 0x2B73F, name = '中日韓統一表意文字擴充區C' },
    { first = 0x2B740, last = 0x2B81F, name = '中日韓統一表意文字擴充區D' },
    { first = 0x2B820, last = 0x2CEAF, name = '中日韓統一表意文字擴充區E' },
    { first = 0x2CEB0, last = 0x2EBEF, name = '中日韓統一表意文字擴充區F' },
    { first = 0x2EBF0, last = 0x2EE5F, name = '中日韓統一表意文字擴充區I' },
    { first = 0x2F800, last = 0x2FA1F, name = '中日韓相容表意文字補充區' },
    { first = 0x30000, last = 0x3134F, name = '中日韓統一表意文字擴充區G' },
    { first = 0x31350, last = 0x323AF, name = '中日韓統一表意文字擴充區H' },
    { first = 0xE0000, last = 0xE007F, name = '標籤' },
    { first = 0xE0100, last = 0xE01EF, name = '變體選擇符補充' },
    { first = 0xF0000, last = 0xFFFFF, name = '補充私人使用區-A' },
    { first = 0x100000, last = 0x10FFFF, name = '補充私人使用區-B' }
}
local rime = require('huma/lib/lib')
-- 碼點
local function get_segment(code)
    local low, high = 1, #segments
    while low <= high do
        local mid = math.floor((low + high) / 2)
        local segment = segments[mid]
        if code < segment.first then
            high = mid - 1
        elseif code > segment.last then
            low = mid + 1
        else
            return segment.name -- 找到范围
        end
    end
    return '未定義區段' -- 不在任何范围内
end


local function filter(input, env)
    local codepoints_option = env.engine.context:get_option('codepoints')
    local segments_option = env.engine.context:get_option('segments')

    for cand in input:iter() do
        local text = cand.text
        local cand_gen = cand:get_genuine()
        if utf8.len(text) ~= 1 or cand_gen.type == 'completion' then
            yield(cand)
        else
            local code = utf8.codepoint(text)
            local comment = codepoints_option and string.format('U+%X', code) or ''
            comment = segments_option and (comment ~= '' and comment .. ' ・ ' or '') .. get_segment(code) or comment
            if comment and comment ~= '' then
                comment = '〔 ' .. comment .. ' 〕'
            end
            local comment = comment .. cand.comment
            cand = rime.generate_candidate(cand, comment)
            yield(cand)
        end
    end
end

return filter
